<?php

/**
 *  Log in a user.
 *
 *  @param string $e_or_c
 *    A user's email or cell.  Will check against a formatted (e.g. with dashes)
 *    and unformatted version of a mobile number, if appropriate.
 *
 *  @param object $account
 *    If available, the account object for the user.  If unspecified, will get the
 *    object from dosomething_api_user_lookup() function.
 *
 *  @see dosomething_api_user_lookup()
 */
function dosomething_api_user_log_in($e_or_c, $account = object()) {
  if (empty($account)) {
    $account = dosomething_api_user_lookup($e_or_c);
  }

  if (!empty($account)) {
  	$u = array('uid' => $account->uid);
  	user_login_submit(array(), $u);
  }
}

/**
 * Load up the related user given and email or cell phone value.
 *
 * @param $value
 *   An email or cell phone value.
 * @return
 *  Either FALSE or the loaded user account.
 */
function dosomething_api_user_lookup($value) {
  $account = FALSE;
  if (valid_email_address($value)) {
    $account = user_load_by_mail($value);
  }
  else if ($number = dosomething_general_valid_cell($value)) {
    $account = dosomething_general_find_user_by_cell($number);
  }
  return $account;
}