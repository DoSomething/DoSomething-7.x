#! /bin/bash
# commands to run as clean up after upgrade (not mission critical)
echo "migrating from nodewords to metatags quick `date`"
drush @ds7 -y metatags-quick-migrate
echo "deleting unwanted nodes `date`"
drush @ds7 -y php-eval "global \$user; \$user = user_load(1); \$result = db_query('select nid from node where type in (\'bc_financial_aid\', \'bc_financial_aid_grantalumni\', \'boot_camp_app\', \'bootcampx\', \'botb\', \'club_materials\', \'college_survey\', \'consulting_program_alumni_form\', \'dsaward_nomination\', \'editorial_notes\', \'feedapi_node\', \'hp_art\', \'increaseyourgreen_report\', \'iyg_2010\', \'iyg_judge\', \'som_judge\', \'speed_catcher\', \'yac_app\', \'youth_act_fair_signup\', \'action_guide_submission\', \'blank_page\', \'campaign_shellproj\', \'campaign_tfj_2011\', \'celebrity_db\', \'disaster_grant\', \'dsu_materials\', \'enviro_grant\', \'feed_the_need\', \'forum\', \'grammy_grant\', \'grant_alumni_update_form\', \'grant_application\', \'info_request\', \'iyg_kits\', \'jet_sweeptakes\', \'lost_found\', \'mdvoltage_application\', \'pitch_grant\', \'plum_grant_app\', \'project_teaser\', \'quiz\', \'rant_rave\', \'reporter\', \'staples_design\', \'story\', \'surge_scholarship\', \'take_action_app\', \'custom_voting\', \'teach_grants\', \'testimonial\', \'throwaway_type\', \'thumb_wars_bumper_sticker\', \'thumb_wars_sock_signup\', \'thumb_wars_sticker_order\', \'ugc_tips_tools\', \'varsity\', \'whitehouse\', \'yacapp\', \'youth_grant_app\')'); foreach (\$result as \$record) {\$nids[] = \$record->nid;} \$result = db_query('select n.nid from node n left join node_type t on n.type = t.type where t.type IS NULL'); foreach (\$result as \$record) {\$nids[] = \$record->nid;} node_delete_multiple(\$nids);" 
echo "deleting crap content types `date`"
drush @ds7 -y php-eval "\$types = array('bc_financial_aid', 'bc_financial_aid_grantalumni', 'boot_camp_app', 'bootcampx', 'botb', 'club_materials', 'college_survey', 'consulting_program_alumni_form', 'dsaward_nomination', 'editorial_notes', 'feedapi_node', 'hp_art', 'increaseyourgreen_report', 'iyg_2010', 'iyg_judge', 'som_judge', 'speed_catcher', 'yac_app', 'youth_act_fair_signup', 'action_guide_submission', 'blank_page', 'campaign_shellproj', 'campaign_tfj_2011', 'celebrity_db', 'disaster_grant', 'dsu_materials', 'enviro_grant', 'feed_the_need', 'forum', 'grammy_grant', 'grant_alumni_update_form', 'grant_application', 'info_request', 'iyg_kits', 'jet_sweeptakes', 'lost_found', 'mdvoltage_application', 'pitch_grant', 'plum_grant_app', 'project_teaser', 'quiz', 'rant_rave', 'custom_voting', 'reporter', 'staples_design', 'story', 'surge_scholarship', 'take_action_app', 'teach_grants', 'testimonial', 'throwaway_type', 'thumb_wars_bumper_sticker', 'thumb_wars_sock_signup', 'thumb_wars_sticker_order', 'ugc_tips_tools', 'varsity', 'whitehouse', 'yacapp', 'youth_grant_app'); foreach (\$types as \$type) {node_type_delete(\$type);}"
echo "post upgrade scripts complete `date`"