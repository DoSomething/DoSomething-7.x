diff --git a/sites/all/modules/webform/includes/webform.submissions.inc b/sites/all/modules/webform/includes/webform.submissions.inc
index f8c0e77..a111a02 100644
--- a/sites/all/modules/webform/includes/webform.submissions.inc
+++ b/sites/all/modules/webform/includes/webform.submissions.inc
@@ -663,14 +663,14 @@ function webform_get_submissions($filters = array(), $header = NULL, $pager_coun
   }
 
   // Query the required submission data.
-  $query = db_select('webform_submitted_data', 'sd');
-  $query->leftJoin('webform_submissions', 's', 's.sid = sd.sid');
+  $query = db_select('webform_submissions', 's');
+  $query->leftJoin('webform_submitted_data', 'sd', 'sd.sid = s.sid');
   $query->leftJoin('users', 'u', 'u.uid = s.uid');
   $query
     ->fields('s')
     ->fields('sd', array('cid', 'no', 'data'))
     ->fields('u', array('name'))
-    ->condition('sd.sid', $sids, 'IN')
+    ->condition('s.sid', $sids, 'IN')
     ->orderBy('sd.sid', 'ASC')
     ->orderBy('sd.cid', 'ASC')
     ->orderBy('sd.no', 'ASC');
@@ -678,7 +678,7 @@ function webform_get_submissions($filters = array(), $header = NULL, $pager_coun
   // By adding the NID to this query we allow MySQL to use the primary key on
   // in webform_submitted_data for sorting (nid_sid_cid_no).
   if (isset($filters['nid'])) {
-    $query->condition('sd.nid', $filters['nid']);
+    $query->condition('s.nid', $filters['nid']);
   }
 
   $result = $query->execute();
diff --git a/sites/all/modules/webform/webform.module b/sites/all/modules/webform/webform.module
index 23d44d9..5aa8617 100644
@@ -2559,13 +2552,15 @@ function _webform_client_form_submit_flatten($node, $fieldset, $parent = 0) {
   if (is_array($fieldset)) {
     foreach ($fieldset as $form_key => $value) {
       $cid = webform_get_cid($node, $form_key, $parent);
-
-      if (is_array($value) && webform_component_feature($node->webform['components'][$cid]['type'], 'group')) {
-        $values += _webform_client_form_submit_flatten($node, $value, $cid);
-      }
-      else {
-        $values[$cid] = $value;
+      if ($cid) {
+        if (is_array($value) && webform_component_feature($node->webform['components'][$cid]['type'], 'group')){
+          $values += _webform_client_form_submit_flatten($node, $value, $cid);
+        }
+        else {
+          $values[$cid] = $value;
+        } 
       }
+
     }
   }
 
